{"is_source_file": true, "format": "JavaScript", "description": "Client-side script managing the chat interface, conversation state, API interactions, and UI updates for the patient health inquiry system.", "external_files": ["localStorage", "window.location", "fetch"], "external_methods": ["document.getElementById", "localStorage.getItem", "localStorage.setItem", "window.location.origin", "window.location.pathname", "URL", "URL.searchParams", "URL.toString", "setInterval", "fetch", "console.log", "console.error"], "published": [], "classes": [], "methods": [{"name": "computeDefaultApiBase()", "description": "Computes a default API base URL considering proxy paths and origin.", "scope": "", "scopeKind": ""}, {"name": "setStatus(text, kind = 'info')", "description": "Sets the status bar text and color based on message and type.", "scope": "", "scopeKind": ""}, {"name": "saveConfig()", "description": "Stores current API base URL and patient ID into localStorage.", "scope": "", "scopeKind": ""}, {"name": "normalizeApiBase(raw)", "description": "Normalizes user-input API base URL, removing trailing slashes and enforcing endpoint paths.", "scope": "", "scopeKind": ""}, {"name": "getApi(path)", "description": "Generates full API endpoint URL from base and path.", "scope": "", "scopeKind": ""}, {"name": "renderMessages()", "description": "Renders chat messages in the UI.", "scope": "", "scopeKind": ""}, {"name": "updateConvoInfo({ message_count, updated_at })", "description": "Updates conversation-related UI elements with latest info.", "scope": "", "scopeKind": ""}, {"name": "pollStatus()", "description": "Polls backend for updated conversation status.", "scope": "", "scopeKind": ""}, {"name": "setConversationId(id)", "description": "Updates the current conversation ID and displays it.", "scope": "", "scopeKind": ""}, {"name": "startConversation()", "description": "Initiates a new conversation with backend using Patient ID.", "scope": "", "scopeKind": ""}, {"name": "sendMessage()", "description": "Sends a patient message to backend, updates chat log, and handles bot follow-up.", "scope": "", "scopeKind": ""}, {"name": "askFollowUp()", "description": "Requests AI follow-up question from backend.", "scope": "", "scopeKind": ""}, {"name": "generateSummary(viewOnly)", "description": "Generates or saves a summary of the conversation based on view-only flag.", "scope": "", "scopeKind": ""}, {"name": "initHealth", "description": "Performs a health check of the backend API on startup."}], "calls": ["fetch", "setInterval", "console.log", "console.error", "JSON.parse", "JSON.stringify"], "search-terms": ["patient health inquiry", "chat interface", "conversation management", "API base URL normalization", "generate summary", "backend health check"], "state": 2, "file_id": 26, "knowledge_revision": 144, "git_revision": "f7692a041c99b96f4b90e04b4cbd14b1fac281e8", "revision_history": [{"89": "9b9bbd1d8442ac0f12de5f7c2facd1069ea9da2c"}, {"92": "bb51a243d8e1bd67e9a4ee83b1ad0a21273ebae0"}, {"93": "bb51a243d8e1bd67e9a4ee83b1ad0a21273ebae0"}, {"94": "bb51a243d8e1bd67e9a4ee83b1ad0a21273ebae0"}, {"95": "4d9fbc1f3de41bd7472cf5e9d7a1e28d8b7c3f6d"}, {"96": "24ed95ebe57b734eaded80f97d2e3b5cabbc314a"}, {"97": "24ed95ebe57b734eaded80f97d2e3b5cabbc314a"}, {"99": "39cc9cff56d859d689e5680d08ff1b0d29bb0b83"}, {"100": "39cc9cff56d859d689e5680d08ff1b0d29bb0b83"}, {"101": "39cc9cff56d859d689e5680d08ff1b0d29bb0b83"}, {"121": "45e314d7caa424531320bae49e0129b335a4e734"}, {"144": "f7692a041c99b96f4b90e04b4cbd14b1fac281e8"}], "ctags": [{"_type": "tag", "name": "apiBase", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    apiBase: effectiveDefaultApiBase,$/", "language": "JavaScript", "kind": "property", "scope": "defaults", "scopeKind": "class"}, {"_type": "tag", "name": "apiBaseUrl", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    apiBaseUrl: document.getElementById('apiBaseUrl'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "askFollowBtn", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    askFollowBtn: document.getElementById('askFollowBtn'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "askFollowUp", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  async function askFollowUp() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^      let body = {};$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "computeDefaultApiBase", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function computeDefaultApiBase() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "conversationId", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    conversationId: null,$/", "language": "JavaScript", "kind": "property", "scope": "state", "scopeKind": "class"}, {"_type": "tag", "name": "convoId", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    convoId: document.getElementById('conversationId'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "defaults", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  const defaults = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "detail", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^        const detail = res.ok ? 'Unexpected response body' : `HTTP ${res.status}`;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "effectiveDefaultApiBase", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  const effectiveDefaultApiBase = isUnderProxy$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "els", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  const els = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "genSaveSummaryBtn", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    genSaveSummaryBtn: document.getElementById('genSaveSummaryBtn'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "genSummaryBtn", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    genSummaryBtn: document.getElementById('genSummaryBtn'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "generateSummary", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  async function generateSummary(viewOnly) {$/", "language": "JavaScript", "kind": "function", "signature": "(viewOnly)"}, {"_type": "tag", "name": "getApi", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function getApi(path) {$/", "language": "JavaScript", "kind": "function", "signature": "(path)"}, {"_type": "tag", "name": "hint", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^        const hint = window.location.pathname.startsWith('\\/proxy\\/')$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "hint", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^      const hint = window.location.pathname.startsWith('\\/proxy\\/')$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isUnderProxy", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  const isUnderProxy = \\/^\\\\\\/proxy\\\\\\/(\\\\d+)\\\\\\/?\\/.test(window.location.pathname);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "messageInput", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    messageInput: document.getElementById('messageInput'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    messages: [], \\/\\/ {sender:'patient'|'bot', text:string}$/", "language": "JavaScript", "kind": "property", "scope": "state", "scopeKind": "class"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    messages: document.getElementById('messages'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "msgCount", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    msgCount: document.getElementById('messageCount'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeApiBase", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function normalizeApiBase(raw) {$/", "language": "JavaScript", "kind": "function", "signature": "(raw)"}, {"_type": "tag", "name": "noteTitle", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    noteTitle: document.getElementById('noteTitle'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "patientId", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    patientId: document.getElementById('patientId'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "patientId", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    patientId: localStorage.getItem('ocean.patientId') || 'patient-123',$/", "language": "JavaScript", "kind": "property", "scope": "defaults", "scopeKind": "class"}, {"_type": "tag", "name": "pollStatus", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  async function pollStatus() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "renderMessages", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function renderMessages() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^      const res = await fetch(url, { method: 'GET' });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "saveConfig", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function saveConfig() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "saveFilename", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    saveFilename: document.getElementById('saveFilename'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "saveResult", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    saveResult: document.getElementById('saveResult'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "sendMessage", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  async function sendMessage() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sendMsgBtn", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    sendMsgBtn: document.getElementById('sendMsgBtn'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "setConversationId", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function setConversationId(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "setStatus", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function setStatus(text, kind = 'info') {$/", "language": "JavaScript", "kind": "function", "signature": "(text, kind = 'info')"}, {"_type": "tag", "name": "startBtn", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    startBtn: document.getElementById('startConversationBtn'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "startConversation", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  async function startConversation() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  let state = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "statusBar", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    statusBar: document.getElementById('statusBar'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "storedApiBase", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  const storedApiBase = localStorage.getItem('ocean.apiBase');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "summaryOutput", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    summaryOutput: document.getElementById('summaryOutput'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^      const text = await res.text().catch(() => '');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "updateConvoInfo", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^  function updateConvoInfo({ message_count, updated_at }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ message_count, updated_at })"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/patient-health-inquiry-and-note-management-2974-2983/frontend/script.js", "pattern": "/^    updatedAt: document.getElementById('updatedAt'),$/", "language": "JavaScript", "kind": "property", "scope": "els", "scopeKind": "class"}], "hash": "c90b0ea203f8e168441b333548dc0791", "format-version": 4, "code-base-name": "chatbot_backend", "filename": "frontend/script.js", "fields": [{"name": "apiBase: effectiveDefaultApiBase,", "scope": "defaults", "scopeKind": "class", "description": "unavailable"}, {"name": "apiBaseUrl: document.getElementById('apiBaseUrl'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "askFollowBtn: document.getElementById('askFollowBtn'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "let body = {};", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "conversationId: null,", "scope": "state", "scopeKind": "class", "description": "unavailable"}, {"name": "convoId: document.getElementById('conversationId'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "genSaveSummaryBtn: document.getElementById('genSaveSummaryBtn'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "genSummaryBtn: document.getElementById('genSummaryBtn'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "messageInput: document.getElementById('messageInput'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "messages: [], \\/\\/ {sender:'patient'|'bot', text:string}", "scope": "state", "scopeKind": "class", "description": "unavailable"}, {"name": "messages: document.getElementById('messages'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "msgCount: document.getElementById('messageCount'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "noteTitle: document.getElementById('noteTitle'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "patientId: document.getElementById('patientId'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "patientId: localStorage.getItem('ocean.patientId') || 'patient-123',", "scope": "defaults", "scopeKind": "class", "description": "unavailable"}, {"name": "saveFilename: document.getElementById('saveFilename'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "saveResult: document.getElementById('saveResult'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "sendMsgBtn: document.getElementById('sendMsgBtn'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "startBtn: document.getElementById('startConversationBtn'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "statusBar: document.getElementById('statusBar'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "summaryOutput: document.getElementById('summaryOutput'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}, {"name": "updatedAt: document.getElementById('updatedAt'),", "scope": "els", "scopeKind": "class", "description": "unavailable"}]}